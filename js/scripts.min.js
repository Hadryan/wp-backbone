function post_link(e){return"#/"+e.get("link").replace(wedevsBackbone.base,"")}(function(e){e(function(){e.fn.center=function(){this.css("top",Math.max(0,(e(window).height()-e(this).outerHeight())/2+e(window).scrollTop())+"px");this.css("left",Math.max(0,(e(window).width()-e(this).outerWidth())/2+e(window).scrollLeft())+"px");return this};var t=function(){e("html, body").animate({scrollTop:e("#masthead").offset().top},100)};_.templateSettings={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g};var n={};_.extend(n,Backbone.Events);var r=Backbone.View.extend({el:"#content",initialize:function(){},fetchPosts:function(e){var t=this;this.collection=new wp.api.collections.Posts;this.collection.fetch({data:{page:e},success:function(n,r,i){t.totalPages=i.xhr.getResponseHeader("X-WP-TotalPages");t.total=i.xhr.getResponseHeader("X-WP-Total");t.currentPage=e;t.render()}})},render:function(){var n=e("#home-view").html();n=_.template(n,{posts:this.collection.models,pages:this.totalPages,total:this.total,currentPage:this.currentPage});e(this.el).html(n);t()}}),i=Backbone.View.extend({el:"#content",initialize:function(){console.log("initializing single post view")},fetchPost:function(e){self=this;this.model=new wp.api.models.Post({ID:e});this.model.fetch({success:function(){self.render()}})},render:function(){var r=e("#single-post-view").html();r=_.template(r,{post:this.model});e(this.el).html(r);n.trigger("post:single",this.model);t()}}),s=Backbone.Model.extend({idAttribute:"ID",defaults:{ID:0,post:0,contnt:"",parent:0,date:"",links:{},author:{name:"",URL:"",avatar:""}}}),o=Backbone.Collection.extend({model:s,url:function(){return wpApiOptions.base+"/posts/"+this.post_id+"/comments"},initialize:function(e){this.post_id=e}}),u=Backbone.View.extend({el:"article #comments",initialize:function(){n.once("post:single",this.initComments,this)},initComments:function(e){var t=this;this.collection=new o(e.id);this.collection.fetch({success:function(){t.render()}})},render:function(){var t=e("#comments-view").html();t=_.template(t,{comments:this.collection.models});e("article #comments").html(t)}}),a=Backbone.Router.extend({routes:{"/":"home","posts/:id/*slug":"singlePost","p/:id":"paged","*actions":"home"},singlePost:function(e,t){(new i).fetchPost(e);new u},home:function(){(new r).fetchPosts(1)},paged:function(e){(new r).fetchPosts(e)}});new a;Backbone.history.start();e(".loading").center();e.ajaxSetup({beforeSend:function(t){e(".loading").show()},complete:function(){e(".loading").hide()}})})})(jQuery);