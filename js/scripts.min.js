function post_link(e){return"#/"+e.get("link").replace(wedevsBackbone.base,"")}(function(e){e(function(){e.fn.center=function(){this.css("top",Math.max(0,(e(window).height()-e(this).outerHeight())/2+e(window).scrollTop())+"px");this.css("left",Math.max(0,(e(window).width()-e(this).outerWidth())/2+e(window).scrollLeft())+"px");return this};_.templateSettings={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g};var t={};_.extend(t,Backbone.Events);var n=Backbone.View.extend({el:"#content",initialize:function(){},fetchPosts:function(e){var t=this;this.collection=new wp.api.collections.Posts;this.collection.fetch({data:{page:e},success:function(n,r,i){t.totalPages=i.xhr.getResponseHeader("X-WP-TotalPages");t.total=i.xhr.getResponseHeader("X-WP-Total");t.currentPage=e;t.render()}})},render:function(){var t=e("#home-view").html();t=_.template(t,{posts:this.collection.models,pages:this.totalPages,total:this.total,currentPage:this.currentPage});e(this.el).html(t)}}),r=Backbone.View.extend({el:"#content",initialize:function(){console.log("initializing single post view")},fetchPost:function(e){self=this;this.model=new wp.api.models.Post({ID:e});this.model.fetch({success:function(){self.render()}})},render:function(){var n=e("#single-post-view").html();n=_.template(n,{post:this.model});e(this.el).html(n);t.trigger("post:single",this.model)}}),i=Backbone.Model.extend({idAttribute:"ID",defaults:{ID:0,post:0,contnt:"",parent:0,date:"",links:{},author:{name:"",URL:"",avatar:""}}}),s=Backbone.Collection.extend({model:i,url:function(){return wpApiOptions.base+"/posts/"+this.post_id+"/comments"},initialize:function(e){this.post_id=e}}),o=Backbone.View.extend({el:"article #comments",initialize:function(){t.once("post:single",this.initComments,this)},initComments:function(e){var t=this;this.collection=new s(e.id);this.collection.fetch({success:function(){t.render()}})},render:function(){var t=e("#comments-view").html();t=_.template(t,{comments:this.collection.models});e("article #comments").html(t)}}),u=Backbone.Router.extend({routes:{"/":"home","posts/:id/*slug":"singlePost","p/:id":"paged","*actions":"home"},singlePost:function(e,t){(new r).fetchPost(e);new o},home:function(){(new n).fetchPosts(1)},paged:function(e){(new n).fetchPosts(e)}});new u;Backbone.history.start();e(".loading").center();e.ajaxSetup({beforeSend:function(t){e(".loading").show()},complete:function(){e(".loading").hide()}})})})(jQuery);